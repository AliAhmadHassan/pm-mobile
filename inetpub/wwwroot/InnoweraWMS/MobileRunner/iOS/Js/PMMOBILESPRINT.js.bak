var isChrome = !!window.chrome && !!window.chrome.webstore;

function getLocation() {
	alert("Testando GeoLocation");
	if (navigator.geolocation) {
		navigator.geolocation.getCurrentPosition(showPosition);
	} else {
		alert("Geolocation is not supported by this browser.");
	}
}

function showPosition(position) {
	alert("Latitude: " + position.coords.latitude);
	alert("Longitude: " + position.coords.longitude);
}

$(document).ready(function () {

	$('#divDisplayOrders').hide();
	$('#divMenu').hide();
	$('#divGET_EQUNR').hide();
	$('#divGET_ORDERS').hide();
	$('#btnDiv_GET_ORDERS').hide();
	$('#divGET_ORDERS_DETAILS').hide();
	$('#btnDiv_GET_ORDERS_DETAILS').hide();
	$('#divDisplaySecurityFormCheck').hide();
	$('#divDisplayGetText').hide();
	$('#divDisplayGet_Warranty').hide();


	$("[itag='btnDisplayOrders']").on("click touchend", function (e) {
		if (!isChrome)
			CommonScripts.ShowLoader("Loading...");
		$('#divDisplayOrders').hide();
		$('#divMenu').hide();
		$('#divGET_EQUNR').hide();
		$('#divGET_ORDERS').hide();
		$('#btnDiv_GET_ORDERS').hide();
		$('#divGET_ORDERS_DETAILS').hide();
		$('#btnDiv_GET_ORDERS_DETAILS').hide();
		$('#divDisplaySecurityFormCheck').hide();
		$('#divDisplayGetText').hide();
		$('#divDisplayGet_Warranty').hide();
		$('#divMainScreen').hide();

		$('#divDisplayOrders').show();

		$('#divDisplayOrders #txtOrderNumber').val("");
		$('#divDisplayOrders #txtCentroDeTrabalho').val("");
		$('#divDisplayOrders #txtEquipmentNumber').val("");
		$('#divDisplayOrders #txtInventoryNumber').val("");
		$('#divDisplayOrders #txtLocalDeInstalação').val("");


		if (!isChrome)
			CommonScripts.HideLoader();
		e.preventDefault();

	});

	$("[itag='btnDisplayNotif']").on("click touchend", function (e) {
		if (!isChrome)
			CommonScripts.ShowLoader("Loading...");
		$('#divDisplayOrders').hide();
		$('#divMenu').hide();
		$('#divGET_EQUNR').hide();
		$('#divGET_ORDERS').hide();
		$('#btnDiv_GET_ORDERS').hide();
		$('#divGET_ORDERS_DETAILS').hide();
		$('#btnDiv_GET_ORDERS_DETAILS').hide();
		$('#divDisplaySecurityFormCheck').hide();
		$('#divDisplayGetText').hide();
		$('#divDisplayGet_Warranty').hide();
		$('#divMainScreen').hide();

		$('#divDisplayOrders').hide();
		$('#divDisplayNotif').show();

		$('.customButtonRunTime').remove();
		$('#divDisplayNotif #menu').append(
			'<a class="customButtonRunTime button" onclick="\
			$(\'#divDisplayNotif\').hide();\
			$(\'#divMainScreen\').show();\
			$(\'.customButtonRunTime\').remove();">voltar</a>'
		);

		$('#divDisplayNotif #menu').append('<a class="button customButtonRunTime" onclick="\
		call_Nota($(\'#divDisplayNotif #txtNotifNumber\').val())" >Executar</a>');

		if (!isChrome)
			CommonScripts.HideLoader();
		e.preventDefault();

	});

	$("[itag='btnExecute_GET_ORDERS']").on("click touchend", function (e) {
		if (!isChrome)
			CommonScripts.ShowLoader("Loading...");
		var oNumber = GetRowData_GET_ORDERS();
		if (oNumber == undefined || oNumber == "") {
			alert("Favor selecionar uma ordem.")
			if (!isChrome)
				CommonScripts.HideLoader();
			e.preventDefault();
			return;
		}
		call_Check_Order(oNumber);
	});

	$("[itag='btnBack']").on("click touchend", function (e) {
		if (!isChrome)
			CommonScripts.ShowLoader("Loading...");
		$('#divDisplayOrders').hide();
		$('#divMenu').hide();
		$('#divMainScreen').show();
		if (!isChrome)
			CommonScripts.HideLoader();
		e.preventDefault();

	});

	$("[itag='btnBackGrid']").on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		$('#divDisplayOrders').hide();
		$('#divMenu').hide();
		$('#divGET_EQUNR').hide();
		$('#divGET_ORDERS').hide();
		$('#btnDiv_GET_ORDERS').hide();
		$('#divGET_ORDERS_DETAILS').hide();
		$('#btnDiv_GET_ORDERS_DETAILS').hide();
		$('#divDisplaySecurityFormCheck').hide();
		$('#divDisplayGetText').hide();
		$('#divDisplayGet_Warranty').hide();
		$('#divDisplayOrders').show();
		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();

	});

	$("[itag='btnExecute']").on("click touchend", function (e) {

		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		var txtInventoryNumberValue = document.getElementById("txtInventoryNumber").value;
		var txtEquipmentNumber = document.getElementById("txtEquipmentNumber").value;
		call_GET_ADDRESS();

		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();

	});

	$('[itag="btnBack_SecurityFormCheck"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		//ActiveGrid("Form20181002001415050");

		$('#divDisplayOrders').hide();
		$('#divMenu').hide();
		$('#divGET_EQUNR').hide();
		$('#divGET_ORDERS').hide();
		$('#btnDiv_GET_ORDERS').hide();
		$('#divGET_ORDERS_DETAILS').hide();
		$('#btnDiv_GET_ORDERS_DETAILS').hide();
		$('#divDisplaySecurityFormCheck').hide();
		$('#divDisplayGetText').hide();
		$('#divDisplayGet_Warranty').hide();
		$('#divDisplayOrders').show();
		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});

	$('[itag="btnBack_GET_ORDERS_DETAILS"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		//ActiveGrid("Form20181002001415050");

		$('#divDisplayOrders').hide();
		$('#divMenu').hide();
		$('#divGET_EQUNR').hide();
		$('#divGET_ORDERS').hide();
		$('#btnDiv_GET_ORDERS').hide();
		$('#divGET_ORDERS_DETAILS').hide();
		$('#btnDiv_GET_ORDERS_DETAILS').hide();
		$('#divDisplaySecurityFormCheck').hide();
		$('#divDisplayGetText').hide();
		$('#divDisplayGet_Warranty').hide();
		$('#divDisplayOrders').show();
		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});


	$('[itag="btnBack_GET_ORDERS"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		//ActiveGrid("Form20181002001415050");

		$('#divDisplayOrders').hide();
		$('#divMenu').hide();
		$('#divGET_EQUNR').hide();
		$('#divGET_ORDERS').hide();
		$('#btnDiv_GET_ORDERS').hide();
		$('#divGET_ORDERS_DETAILS').hide();
		$('#btnDiv_GET_ORDERS_DETAILS').hide();
		$('#divDisplaySecurityFormCheck').hide();
		$('#divDisplayGetText').hide();
		$('#divDisplayGet_Warranty').hide();
		$('#divDisplayOrders').show();
		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});


	$('[itag="btnBack_Warranty"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		$('#divDisplayGet_Warranty').hide();
		$('#divDisplaySecurityFormCheck').show();
		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});

	$('[itag="btnExecute_GET_ORDERS_DETAILS"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");

		$('#lblGetText').html(
			$('[itag="btnExecute_GET_ORDERS_DETAILS"]').attr('message')
		);

		$('#divGET_ORDERS_DETAILS').hide();
		$('#divDisplayGetText').show();

		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});

	$('[itag="btnBack_Get_Text"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");

		$('#divGET_ORDERS_DETAILS').show();
		$('#divDisplayGetText').hide();

		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});

	$('[itag="btnWARRANTY_SecurityFormCheck"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");

		var oNumber = GetRowData_GET_Equip();
		if (oNumber == "")
			alert("Favor selecionar uma linha de Garantia");
		else
			call_GetWarranty(oNumber);

		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});


	$('[itag="btnConfirm_SecurityFormCheck"]').on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		$('#divDisplaySecurityFormCheck').hide();
		var oNumber = $('#Form20181016150505334 #txtNrOrder').val();
		call_GET_ORDER_DETAILS(oNumber);

		//call_Check_Order(oNumber);
		if (!isChrome) CommonScripts.HideLoader();
		e.preventDefault();
	});

	$("[itag='btnSave']").on("click touchend", function (e) {

		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		var FormID = $(this).attr("formid");
		CheckValidation(function (status) {
			if (status == true) {
				SubmitPage(FormID, "Save", $("[itag='btnSave']"));
			}
		});
		e.preventDefault();
	});

	$("[itag='btnSendForReview']").on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		var FormID = $(this).attr("formid");
		CheckValidation(function (status) {
			if (status == true) {
				SubmitPage(FormID, "Review", $("[itag='btnSendForReview']"));
			}
		});
		e.preventDefault();
	});

	$("[itag='btnTest']").on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		var FormID = $(this).attr("formid");
		CheckValidation(function (status) {
			if (status == true) {
				SubmitPage(FormID, "Test", $("[itag='btnTest']"));
			}
		});
		e.preventDefault();
	});

	$("[itag='btnSendToSAP']").on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		var FormID = $(this).attr("formid");
		CheckValidation(function (status) {
			if (status == true) {
				SubmitPage(FormID, "SAP", $("[itag='btnSendToSAP']"));
			}
		});
		e.preventDefault();
	});

	/* Added for Start Workflow by Abhishek Bedre on 05-08-2017 */
	$("[itag='btnStartWorkflow']").on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		var FormID = $(this).attr("formid");
		CheckValidation(function (status) {
			if (status == true) {
				SubmitPage(FormID, "Workflow", $("[itag='btnStartWorkflow']"));
			}
		});
		e.preventDefault();
	});

	$("[itag='btnDelete']").on("click touchend", function (e) {
		if (!isChrome) CommonScripts.ShowLoader("Loading...");
		BLProcessFile.DeleteRecord();
		e.preventDefault();
	});

	$(document).on("click touchend", "[itag='inserttestdata']", function (e) {
		$(".listdetailtableNew tbody").html("");
		$(".cancelbtn").hide();
		$('#Form20181004192116851 [itable="header"] input[imapvalue="A"]').val("4920");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="B"]').val("3000");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="C"]').val("3000");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="D"]').val("PLNT");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="E"]').val("62130");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="F"]').val("A2");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="G"]').val("ZB03");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="H"]').val("FVVD");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="I"]').val("SAR");
		$('#Form20181004192116851 [itable="header"] input[imapvalue="J"]').val("ZB03");
		e.preventDefault();
	});

	document.addEventListener("deviceready", onDeviceReady, false);
});

function onDeviceReady() {
	if (AppVersion.replace(/\./g, '') < 414) {
		navigator.notification.alert("Process app is not compatible with current version of InnoweraApp. Please update InnoweraApp from AppStore.", function () {
			if (!isChrome) CommonScripts.GoBack();
		}, "Information", "OK");
	}
	var sesUserSettings = JSON.parse(sessionStorage.UserSettings);
	//Load Record
	var strDataID = CommonScripts.QueryStringParams("DataID");

	if (strDataID) {
		BLProcessFile.GetProcessData(strDataID, GetProcessDataError, GetProcessDataSuccess);

		function GetProcessDataError(jsonError) {
			if (!isChrome) CommonScripts.PrintConsole(jsonError);
		}

		function GetProcessDataSuccess(jsonResult) {
			if (jsonResult) {
				if (jsonResult.rows.length > 0) {
					BLProcessFile.PaintValues(jsonResult.rows.item(0), PaintValuesError, PaintValuesSuccess);
				} else {
					if (!isChrome) CommonScripts.PrintConsole("No record found.");
				}
			} else {
				if (!isChrome) CommonScripts.PrintConsole("DB object is null");
			}
		}

		function PaintValuesError(josnError) {

		}

		function PaintValuesSuccess(jsonSuccess) {

		}
	}
}

function SubmitPage(FormID, PostType, eleMainPage) {
	$("input").blur();
	$("textarea").blur();

	$("#MenuAction").attr("data-mfb-state", "close");
	$(".mfb-component__button--main").addClass("m-progress");
	var imgPath = eleMainPage.children("img").attr("src")
	$(".mfb-component__button--main").children(".mfb-component__main-icon--resting").attr("src", imgPath)
	$(".mfb-component__button--main").css("background", eleMainPage.css("background"));


	var IsTestRun = 0,
		IsSave = 0,
		IsDirectPost = 0,
		IsReview = 0,
		IsReset = 0;
	var strAction = "";

	switch (PostType) {
		case "SAP":
			IsDirectPost = 1;
			strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
			break;
		case "Test":
			IsTestRun = 1;
			strAction = $("[itag='btnTest']").attr("data-mfb-label");
			break;
		case "Save":
			IsSave = 1;
			strAction = $("[itag='btnSave']").attr("data-mfb-label");
			break;
		case "Review":
			IsReview = 1;
			strAction = $("[itag='btnSendForReview']").attr("data-mfb-label");
			break;
		case "Reset":
			IsReset = 1;
			break;
			/* Added in InnoweraApp 5.1.2 by Abhishek Bedre on 05-08-2017 */
		case "Workflow":
			IsDirectPost = 1;
			strAction = $("button[itag='btnStartWorkflow']").attr("data-mfb-label");
			break;
	}

	var UserNote = $("#" + FormID + " textarea[itag='txtusernote']").val();
	var FileType = $("#" + FormID).attr("ifiletype");

	if (PostType == "reset") {
		BLProcessFile.ResetForm();
		return;
	}

	var jsonInformation = {};
	jsonInformation.PostType = PostType;
	jsonInformation.ProcessType = FileType;
	jsonInformation.FormID = FormID;
	jsonInformation.Action = strAction;

	jsonInformation.IsTestRun = IsTestRun;
	jsonInformation.IsReviewData = IsReview; //IsReviewData
	jsonInformation.IsSave = IsSave;
	jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

	jsonInformation.UserNote = UserNote;

	jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
	jsonInformation.DataID = CommonScripts.GetGUID();

	jsonInformation.AdditionalData = [];
	jsonInformation.AutoShowresult = 1;
	jsonInformation.IsDoNotSaveInSentbox = 0;
	jsonInformation.IsUpdate = 0;
	//jsonInformation.MYSAPSSO2 = 0;

	var arrHeader = BLProcessFile.GetHeader(jsonInformation);
	var arrFooter = BLProcessFile.GetFooter(jsonInformation);

	/* Generate the object to be save or to send to IWMS  */
	jsonInformation.HeaderData = JSON.stringify(arrHeader);
	jsonInformation.LoopData = JSON.stringify(arrFooter);

	/* Added in InnoweraApp 5.1.2 by Abhishek bedre on 05-08-2017 */
	if (PostType.toLowerCase() == "workflow") {
		jsonInformation.IsStartWorkflow = 1;
		jsonInformation.TemplateSheetName = $("#hdnTemplateSheetName").val().trim();
	}

	BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

	function ProcessOperationError(jsonError) {
		CommonScripts.HideLoader();
		$(".mfb-component__main-icon--resting").attr("src", "../../../new_images/ellipsis.png")
		$(".mfb-component__button--main").removeClass("m-progress");
		$(".mfb-component__button--main").removeAttr("style");
		$("#MainButton").removeAttr("data-mfb-label")
		CommonScripts.PrintConsole(jsonError);
		var parameterofQuery = ["Error", "PS-03", "Error while processing record. [" + JSON.stringify(jsonError) + "]"];
		CommonScripts.SaveLog(parameterofQuery, 1, CommonScripts.OpenGeneralDB());

		// This will show the exact message if available from the IWMS server otherwise
		// will show the default message.
		if (jsonError.responseJSON && jsonError.responseJSON.ExceptionMessage) {
			navigator.notification.alert(jsonError.responseJSON.ExceptionMessage, null, "Information", "OK");
		} else {
			navigator.notification.confirm("There is an error while processing record. Please contact to your IT Administrator.", function (btnIndex) {
				navigator.notification.alert(JSON.stringify(jsonError), null, "Information", "OK");
			}, "Information", "OK");
		}

		/*navigator.notification.confirm("There is an error while processing record. Please contact to your IT Administrator.",
		function (btnIndex) {
		   ErrorDetails(btnIndex, jsonError);
		}, "Information", ["OK", "Details"]);
		
        function ErrorDetails(btnIndex, jsonError) {
            if (btnIndex == 2) {
                if (jsonError.responseJSON && jsonError.responseJSON.ExceptionMessage) {
                    navigator.notification.alert(jsonError.responseJSON.ExceptionMessage, null, "Critical error", "OK");
                } else {
                    navigator.notification.alert(JSON.stringify(jsonError), null, "Critical error", "OK");
                }
            }
        }*/
	}


	function ProcessOperationSuccess(jsonRecordWithResult) {
		CommonScripts.HideLoader();
		$(".mfb-component__main-icon--resting").attr("src", "../../../new_images/ellipsis.png")
		$(".mfb-component__button--main").removeClass("m-progress");
		$(".mfb-component__button--main").removeAttr("style");
		$("#MainButton").removeAttr("data-mfb-label")
		var endDate = new Date();
		CommonScripts.PrintConsole("Total time for Processing : " + ((endDate - startedDate) / 1000));
		CommonScripts.PrintConsole("Mobile Process time : " + (((endDate - startedDate) - (processExecutionEnd - processExecutionStarted)) / 1000));
		/* This event is for customisation. Need to handle if there is any task after this */
		var parameterofQuery = ["Success", "PS-06", "Post Process has been successfully done."];
		CommonScripts.SaveLog(parameterofQuery, 1, CommonScripts.OpenGeneralDB());
		CommonScripts.PrintConsole("Process Completed");
		CommonScripts.PrintConsole(jsonRecordWithResult);
	}
}

/* Added for Convert To SAPTable by Hiren Taior on 26-09-2018 */
function convertToSAPTable(Data, tableidx) {
	try {

		var columnName = [];

		var headerRow = Data[tableidx][0];
		for (var k = 0; k < headerRow.length; k++) {

			columnName.push(headerRow[k]);
		}

		var DataRow = Data[tableidx][1];
		var DataValue = [];

		for (var i = 0; i < DataRow.length; i++) {

			DataValue.push(DataRow[i]);
		}

		var SapTable = [];
		var obj = {};

		for (var p = 0; p < DataValue.length; p++) {

			for (var j = 0; j < columnName.length; j++) {
				obj[columnName[j]] = DataValue[p][j];

				//console.log("obj");
				//console.log(obj);                         
			}

			SapTable.push(obj);
			obj = {};
		}

		//console.log(JSON.stringify(SapTable));
		return SapTable;

	} catch (e) {
		alert(JSON.stringify(e));
	}
}

/* Added for Row Data from Grid by Hiren Taior on 28-09-2018 */
function GetRowData_GET_ORDERS() {
	var myGrid = $('#tableGrid'),
		selRowId = myGrid.jqGrid('getGridParam', 'selrow'),
		celValue = myGrid.jqGrid('getCell', selRowId, 'Nº ordem');
	//alert(celValue);
	return celValue;
}

/* Added for Row Data from Grid by Ali Hassan on 17-10-2018 */
function GetRowData_GET_Equip() {
	var myGrid = $('#tableGrid'),
		selRowId = myGrid.jqGrid('getGridParam', 'selrow'),
		celValue = myGrid.jqGrid('getCell', selRowId, 'Nº equipamento');
	//alert(celValue);
	return celValue;
}

/* Added for call process file GET_EQUNR by Hiren Taior on 02-10-2018 */
function call_GET_EQUNR() {
	try {

		var PostType = "SAP";
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				//strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				strAction = "";
				break;
		}

		var UserNote = "";
		var FileType = "Data Extractor";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20180927230137502";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;

		//Gat value from the form control
		var InventoryNumber = document.getElementById("txtInventoryNumber").value;

		//Preparing Data for processFile
		var arrHeader = 'A->' + InventoryNumber;
		var arrFooter = "";

		// Generate the object to be save or to send to IWMS  
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);


	} catch (e) {
		alert(JSON.stringify(e));
		CommonScripts.HideLoader();
	}

	function ProcessOperationError(jsonError) {
		alert(JSON.stringify(jsonError));
		CommonScripts.HideLoader();
	}


	function ProcessOperationSuccess(jsonRecordWithResult) {
		CommonScripts.ShowLoader("Loading...");
		var result = jsonRecordWithResult.ResultObject.SapReturnTable;
		//alert(JSON.stringify(result));
		var data;
		for (key in result) {
			if (result.hasOwnProperty(key)) {
				var value = JSON.stringify(result[key]);
				data = JSON.parse(value);
				document.getElementById("txtEquipmentNumber").value = data.EQUNR;
			}
		}

		CommonScripts.HideLoader();
	}


}

/* Added for call process file GET_ADDRESS by Hiren Taior on 03-10-2018 */
function call_GET_ADDRESS() {
	try {

		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181002001415050";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost	

		jsonInformation.UserNote = UserNote;

		//jsonInformation.ProcessFile = "GET_ORDERS.iff";
		//jsonInformation.ProcessCode = "ZPMF_GET_ORDERS_IW39";

		//jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		//jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		//Gat value from the form control
		var EquipmentNumber = document.getElementById("txtEquipmentNumber").value;
		var txtOrderNumber = document.getElementById("txtOrderNumber").value;
		var txtCentroDeTrabalho = document.getElementById("txtCentroDeTrabalho").value;
		var txtInventoryNumber = document.getElementById("txtInventoryNumber").value;
		var txtLocalDeInstalação = document.getElementById("txtLocalDeInstalação").value;


		var column = ['A', 'B', 'E', 'F', 'C', 'D'];
		var row = [txtOrderNumber, EquipmentNumber, txtInventoryNumber, 'x', txtLocalDeInstalação, txtCentroDeTrabalho];
		var temp = [];
		temp.push(column);
		temp.push(row);

		var arrHeader = temp;
		var arrFooter = "";

		//alert(JSON.stringify(arrHeader));

		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		/* Added in InnoweraApp 5.1.2 by Abhishek bedre on 05-08-2017 
		if (PostType.toLowerCase() == "workflow") {
			jsonInformation.IsStartWorkflow = 1;
			jsonInformation.TemplateSheetName = $("#hdnTemplateSheetName").val().trim();
		}*/

		//alert(JSON.stringify(jsonInformation));

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();
			alert(JSON.stringify(jsonError));
		}

		function ProcessOperationSuccess(jsonRecordWithResult) {
			CommonScripts.HideLoader();
			//alert("Success");
			//var result = jsonRecordWithResult.ResultObject.SapReturnTable;
			var result = jsonRecordWithResult.ResultObject.ReturnTableCollection;
			// alert(JSON.stringify(result[0]));
			// DataBinding($('#Form20181002001415050 [itable="tblDataDE"]'), result[0]);


			//CommonScripts.PrintConsole(jsonRecordWithResult);	
			var _SAPTable = convertToSAPTable(result, 0);
			//alert("_SAPTable");
			//alert(JSON.stringify(_SAPTable));

			// Paint Grid
			$('#divGET_ORDERS').show();
			$('#btnDiv_GET_ORDERS').show();
			// $('#divDisplayOrders').hide();
			// return ;
			var sapReturnTable = _SAPTable;
			var columns = [];
			var columnNames = []

			if ($("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").has('tbody')) {
				var arrDataColumn = $("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE'] > thead > tr > th")
				for (i = 0; i < arrDataColumn.length; i++) {
					columnNames.push($(arrDataColumn[i]).html());
					columns.push($(arrDataColumn[i]).attr("imatno"));
				}
			} else {
				$("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").append("<tbody></tbody>");
			}

			//Configure the jqGrid
			var strJqGrid = '<div id="divGrid" class="divGrid">' +
				'<table id="tableGrid">' +
				'<tr><td/></tr>' +
				'</table>' +
				'<div id="divPager">' +
				'</div>' +
				'</div>';

			$("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").hide();
			$("#divGrid").remove();
			//ActiveGrid(jsonRecordWithResult.FormID);
			$("#" + jsonRecordWithResult.FormID + " .datacontent").append(strJqGrid);

			var arrTableColumnLabel = []
			var arrTableColumnData = []

			for (var j = 0; j < columns.length; j++) {

				arrTableColumnLabel.push(columnNames[j]);
				arrTableColumnData.push({
					"name": columns[j],
					"align": "center",
					"index": columns[j],
					"searchoptions": {
						"sopt": ['cn', 'nc', 'bw', 'bn', 'ew', 'en']
					}
				});
			}

			//Check for the Date column
			for (var i = 0; i < sapReturnTable.length; i++) {
				tempArr = {};
				for (key in sapReturnTable[i]) {
					var value = sapReturnTable[i][key];
					if (value) {
						if (CheckingDate(value.toString())) {
							CommonScripts.GetDateInDeviceFormat(new Date(value), 0, sapReturnTable[i], key);
						}
					}
				}
			}
			if (jsonRecordWithResult.ResultObject.IsAttachment == 0) {
				var jsonJQGridValues = {
					ColumnLabel: arrTableColumnLabel,
					ColumnData: arrTableColumnData,
				}

				setTimeout(function () {
					CommonScripts.ShowLoader("Loading data...");
					CommonScripts.BindJQGrid(sapReturnTable, jsonJQGridValues, false, function () {
						CommonScripts.HideLoader();
						$("#divGrid .ui-btn").addClass("ui-alt-icon");
						if (DeviceType == "Tablet") {
							var setHeight = $(window).height() - 400;
							$("#gview_tableGrid").css("height", setHeight);
							var setTableHeight = setHeight - 80;
							$("#divGrid div[data-role='content']").css("height", setTableHeight);
							if (BLProcessFile.SetHeightProcessFile) {
								BLProcessFile.SetHeightProcessFile();
							}
						}

						cbGridLoadComplete(jsonRecordWithResult);
					}, cbOnSortCol);
				}, 100);

			}

			$('#divDisplayOrders').hide();
			CommonScripts.HideLoader();

		}


	} catch (e) {
		alert(JSON.stringify(e));
	}
}

/* Added for call process file GET_ORDER_DETAILS by Hiren Taior on 04-10-2018 */
function call_GET_ORDER_DETAILS(oNumber) {
	try {
		var OrderNumber = oNumber;
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181112114946165";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		var column = ['A'];
		var row = [oNumber];
		var temp = [];
		temp.push(column);
		temp.push(row);

		var arrHeader = temp;
		var arrFooter = "";

		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();
			alert(JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {


			//alert(JSON.stringify(jsonRecordWithResult));

			var result = jsonRecordWithResult.ResultObject.ReturnTableCollection;
			var _SAPTable = convertToSAPTable(result, 2);

			//Get Value for Form Field ---------------------------------------------

			var resultSAP_TBL = jsonRecordWithResult.ResultObject.SapReturnTable;
			//alert(JSON.stringify(resultSAP_TBL));
			var data;
			for (key in resultSAP_TBL) {
				if (resultSAP_TBL.hasOwnProperty(key)) {
					var value = JSON.stringify(resultSAP_TBL[key]);
					data = JSON.parse(value);
					//alert(JSON.stringify(data));
					//document.getElementById("txtNºordem").value = data.D;
					$('#btnDiv_GET_ORDERS_DETAILS #txtTpOrder').val(data.C)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtBreveOrdem').val(data.E)
					$('#btnDiv_GET_ORDERS_DETAILS #txtNOrdem').val(data.D.replace(/^0+/, ''))
					$('#btnDiv_GET_ORDERS_DETAILS #TxtTipoAtividadeManutencao').val(data.O)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtDescricaoTipoAtividade').val(data.P)


					$('#btnDiv_GET_ORDERS_DETAILS #TxtGrpPlanej').val(data.Q)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtCentroPlanej').val(data.R)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtDescGrpPlanej').val(data.S)

					$('#btnDiv_GET_ORDERS_DETAILS #TxtCentroTrabalho').val(data.T)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtCentroCentroTrabalho').val(data.U)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtDescCentroTrabalho').val(data.V)


					$('#btnDiv_GET_ORDERS_DETAILS #TxtLocalInstalacao').val(data.W)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtDescLocalInstalacao').val(data.X)

					$('#btnDiv_GET_ORDERS_DETAILS #TxtCodEquipamento').val(data.Y.replace(/^0+/, ''))
					$('#btnDiv_GET_ORDERS_DETAILS #TxtDescCodEquipamento').val(data.Z)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtNInventario').val(data.AA)


					$('#btnDiv_GET_ORDERS_DETAILS #TxtInicioBase').val(data.AB)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtFimBase').val(data.AC)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtNotificador').val(data.AL)


					$('#btnDiv_GET_ORDERS_DETAILS #TxtNota').val(data.AD.replace(/^0+/, ''))
					$('#btnDiv_GET_ORDERS_DETAILS #TxtInicioAvariaData').val(data.AE)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtInicioAvariaHora').val(data.AG)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtFimAvariaData').val(data.AF)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtFimAvariaHora').val(data.AH)


					$('#btnDiv_GET_ORDERS_DETAILS #cbxParada').attr('checked', data.AI == "X" ? true : false)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtDuracao').val(data.AJ)
					$('#btnDiv_GET_ORDERS_DETAILS #TxtDuracaoUnidadeTempo').val(data.AK)
				}
			}

			//------------------- END Form Field -----------------------------------

			// Paint Grid -----------------------------------------------------------
			$('#divGET_ORDERS').hide();
			$('#btnDiv_GET_ORDERS').hide();

			$('#btnDiv_GET_ORDERS_DETAILS').show();
			$('#divGET_ORDERS_DETAILS').show();


			var sapReturnTable = _SAPTable;
			var columns = [];
			var columnNames = []

			//alert(JSON.stringify(jsonRecordWithResult.FormID));

			if ($("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").has('tbody')) {
				var arrDataColumn = $("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE'] > thead > tr > th")
				for (i = 0; i < arrDataColumn.length; i++) {
					columnNames.push($(arrDataColumn[i]).html());
					columns.push($(arrDataColumn[i]).attr("imatno"));
				}
			} else {
				$("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").append("<tbody></tbody>");
			}

			//Configure the jqGrid
			var strJqGrid = '<div id="divGrid" class="divGrid">' +
				'<table id="tableGrid">' +
				'<tr><td/></tr>' +
				'</table>' +
				'<div id="divPager">' +
				'</div>' +
				'</div>';

			$("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").hide();

			$("#divGrid").remove();
			//ActiveGrid(jsonRecordWithResult.FormID);
			$("#" + jsonRecordWithResult.FormID + " .datacontent").append(strJqGrid);
			//$("#" + jsonRecordWithResult.FormID).append(strJqGrid);

			var arrTableColumnLabel = [];
			var arrTableColumnData = [];

			for (var j = 0; j < columns.length; j++) {

				arrTableColumnLabel.push(columnNames[j]);
				arrTableColumnData.push({
					"name": columns[j],
					"align": "center",
					"index": columns[j],
					"searchoptions": {
						"sopt": ['cn', 'nc', 'bw', 'bn', 'ew', 'en']
					}
				});
			}

			//Check for the Date column
			for (var i = 0; i < sapReturnTable.length; i++) {
				tempArr = {};
				for (key in sapReturnTable[i]) {
					var value = sapReturnTable[i][key];
					if (value) {
						if (CheckingDate(value.toString())) {
							CommonScripts.GetDateInDeviceFormat(new Date(value), 0, sapReturnTable[i], key);
						}
					}
				}
			}
			if (jsonRecordWithResult.ResultObject.IsAttachment == 0) {
				var jsonJQGridValues = {
					ColumnLabel: arrTableColumnLabel,
					ColumnData: arrTableColumnData,
				}


				setTimeout(function () {
					CommonScripts.ShowLoader("Loading data...");
					CommonScripts.BindJQGrid(sapReturnTable, jsonJQGridValues, false, function () {
						CommonScripts.HideLoader();
						$("#divGrid .ui-btn").addClass("ui-alt-icon");
						if (DeviceType == "Tablet") {
							var setHeight = $(window).height() - 400;
							$("#gview_tableGrid").css("height", setHeight);
							var setTableHeight = setHeight - 80;
							$("#divGrid div[data-role='content']").css("height", setTableHeight);
							if (BLProcessFile.SetHeightProcessFile) {
								BLProcessFile.SetHeightProcessFile();
							}
						}

						cbGridLoadComplete(jsonRecordWithResult);

						result = jsonRecordWithResult.ResultObject;
						//alert("Success: " + JSON.stringify(result));
						$('[itag="btnExecute_GET_ORDERS_DETAILS"]').attr('message', 'testeasd');
						$('[itag="btnExecute_GET_ORDERS_DETAILS"]').show();





						$('[itag="btnExecute_GET_ORDERS_DETAILS"]').attr('message', '');
						var indexText = [];
						for (let i = 0; i < result.ReturnTableCollection[3][1].length; i++) {
							const element = result.ReturnTableCollection[3][1][i];
							if (element[3] == "0000000000") {

								var textmessage = "";
								for (let i = element[4] - 1; i < element[5] - 1; i++) {

									const lineMessage = result.ReturnTableCollection[4][1][i];
									textmessage += lineMessage[1] + "<br/>"
								}


								if (element[2] == "" && element[1] == "" && element[0] != "") {
									$('[itag="btnExecute_GET_ORDERS_DETAILS"]').attr('message', textmessage);
								} else if (element[1] != "" && element[0] != "") {
									//debugger;

									var tableTemp = $('#divGET_ORDERS_DETAILS #tableGrid tr');
									tableTemp.each(function () {
										const columns = $(this).find('td');
										// alert("columns[0].innerText.trim(): '" + columns[0].innerText.trim() + "'");
										// alert("element[1]: '" + element[1] + "'");
										// alert("columns[1].innerText.trim(): '" + columns[1].innerText.trim() + "'");
										// alert("element[2]: '" + element[2] + "'");
										if (columns[0].innerText.trim() == element[1] && columns[1].innerText.trim() == element[2]) {
											//debugger;

											var colImg = $(this).find('td').get(7);
											$(colImg).append("<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAE+ElEQVR42q1Wa1CUVRh+zrdXdhEQViBtNTEcCZDFRDPNG+I9UWt0wqkhL2VokkpiQyqKlxSaGvOCGYiUlxlHS8fJaUZl8sKUoyiy7MAyEKINXpdiuOwuu/v2fqsWMq3DZOeb5/txvvc8z3mf95x3V6D7Q8+Yy5jKiGEEMtoZVsYZxneMxq6LRDfJF6hU6s1Jk6eETp02neJN8SIkJJgcDoeoqbHi7OnTdPjQAYfNZvuSY9cz7N0VUDD2xsbFv5u9cQsGx0RDrVJRc0uLaG2zk0qlFMFBAVBIErXy3OZNOfi2eP+vvGYa40F3BHaNHD1u8da8L9ArpCcsNfU4UVqJ63fdcJIS8LjQV9eBSSYjxgw3oYdeh+KiAmSvW3uJ146VM3mawIwXIiJ/yC/Yj/BQgzh57jKOVbkxfcxQmhIXJgz+amqxu0RJ1QMcOltO/T31Im32WI4NoU3r1wrO5DPm+MSXgDxfuTFvR9TkiYl0vswiCislvJ00GHqtivir/JA3jt9ul4cOnq8VxuZrSJ87gXQapZgw9jU71yTCl8CoiMhB577aUyh7jhVHzRgQGw8/Ldui4CVSp2UkKxC75cEvV6uRNtCO0cPjUVyQj907d2T6Elg3/Y23sj9avgIVtQ2UWekv/IP00OnV0GqVXFxJ8HiYgVsW8BA6PKK52YHY+5doxaxRovFmHd5JmfuTL4ED76WvTpk5MxknK27RrqZQAa0K0HAGKomglIRSIZGSjZKYW2KL4HQLsrvQ/04FrRn3ojAE6pA4esRvvgS+T8tYkzwxaQKOW+9jn6MP4MfkskVqPrlKifcuHtnjAe+ez4vLi8jbFnyaEAZjuAHjRw2740tgX8qCpakzkpNx5V4b5TqeF9CpHopoFAQVF0Li8srlZu/hYJ/4RKGtAy/fukbL4sKFXqPAm69PqvYlsHLEuMm5ixYv4aJKWPwgBM5g7gyyiDcLyTvvzcDplgUgk6PFiXn1F5AU1Q+3G2qxeuWyY74EooINYZWZG/JERL8+tOdGszjTNxphwVrOgo+phjNQcJE9nEEHk7e7qOkPhzBYLViu/pP4UorDRXtw6uTx+U+7aKeTUxYmjk9MorDQEJFl4243JBYRgdonBTiDplYnlZvrxKIGM4xB/qQkl0h/P/VuR4fT5z34mPFh1OAhxjmpaRTgrxPhYQYUtbrRGBdLA/oYRADXwu7yiHpbC9pLL9PspjsiUKmE3k9LO/NyREX51YXMUfBvAtv6RkRmLFqyHEPiYhEQEIAfS0qh02oR3isYDo8bdTo/NGk1ULfb8dw9G3qq1WhpbeMYDY4Uf43S8yVFzDP/cUvoQj4wIyNrA0YmmIQ/N6+Si5do26Zs8ZJpGGLih0KlVHovmMQdlIdgQKNWU9O9RnH0QCHV19Xky9kz3F0FtvLOV2Vk5eDVBBNxZxRl5mr8fKGU8nPX3eTvVi584sAYE3ob+wm9vgd53C5hu38b1eZyqqupquKY1YwTnXcsOtvyiNzbdq8w+dXrFhz8Zjt+v1G7imPyGIPwsNdHM4Lw5C/aRbkzdfVbFshiW3L+scUPZWYrlV23CCYnJpeJV+E/Dlmg4fPdxcYxI4f9bUtZhYUO7t0umDz3WcgfCxz9YGn6LLlzXjFbO9sik2c+C/ljAfnfwak581Jf6T0gWhzZn//MtnQVwCORQkYCQz5mm/8Pcnn8BdofAzKB5Z7nAAAAAElFTkSuQmCC' />");
											$(this).find('td img').attr('message', textmessage);
											$(this).find('td img').click(function () {
												CommonScripts.ShowLoader("Loading...");

												$('#lblGetText').html(
													$(this).attr('message')
												);

												$('#divGET_ORDERS_DETAILS').hide();
												$('#divDisplayGetText').show();

												CommonScripts.HideLoader();
												e.preventDefault();
											});
										}
									});

									console.log(JSON.stringify(tableTemp));
								}
							}
						}
						CommonScripts.HideLoader();
					}, cbOnSortCol);
				}, 100);

			}

			$('#divDisplayOrders').hide();



			// setTimeout(function () {
			// 	call_GET_GET_NOTIFICATION(OrderNumber);
			// }, 200);

		}


	} catch (e) {
		alert(JSON.stringify(e));
	}

}

/* Added for call process file _GET_NOTIFICATION by Hiren Taior on 04-10-2018 */
function call_GET_GET_NOTIFICATION(OrderNumber) {
	try {
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181003230721394";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		var column = ['A'];
		var row = [OrderNumber];
		var temp = [];
		temp.push(column);
		temp.push(row);

		var arrHeader = temp;
		var arrFooter = "";

		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();
			alert(JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {

			//alert("Success");

			//Get Value for Form Field ---------------------------------------------

			var resultSAP_TBL = jsonRecordWithResult.ResultObject.SapReturnTable;
			//alert(JSON.stringify(resultSAP_TBL));
			var data;
			for (key in resultSAP_TBL) {
				if (resultSAP_TBL.hasOwnProperty(key)) {
					var value = JSON.stringify(resultSAP_TBL[key]);
					data = JSON.parse(value);
					//alert(JSON.stringify(data));
					document.getElementById("txtCódigoParada").value = data.C;
					document.getElementById("txtInícioDaAvariaData").value = data.D;
					document.getElementById("txtDataFinAvaria").value = data.E;
					document.getElementById("txtHoraIniAvaria").value = data.F;
					document.getElementById("txtHoraFinAvaria").value = data.G;
					document.getElementById("txtDuraçãodaParada").value = data.H;
					document.getElementById("txtNotificador").value = data.I;

				}
			}

			setTimeout(function () {
				call_GetText(OrderNumber);
			}, 200);
			//------------------- END Form Field -----------------------------------
		}
	} catch (e) {
		alert(JSON.stringify(e));
	}

}

/* Added for call process file _Check_Order by Ali Hassan on 2018-10-17 */
function call_Check_Order(OrderNumber) {
	try {
		$('#divGET_ORDERS_DETAILS').hide();
		$('#divDisplayOrders').hide();
		$('#divGET_ORDERS').hide();

		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181016150505334";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		$('#Form20181016150505334 #txtNrOrder').val(OrderNumber);

		var column = ['A'];
		var row = [OrderNumber];
		var temp = [];
		temp.push(column);
		temp.push(row);

		//alert(JSON.stringify(temp));
		var arrHeader = temp;
		var arrFooter = "";

		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();
			alert(JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {
			CommonScripts.HideLoader();
			//alert("Success");

			//Get Value for Form Field ---------------------------------------------




			//------------------- END Form Field -----------------------------------

			//------------------- Grid ---------------------------------------------
			{
				var result = jsonRecordWithResult.ResultObject.ReturnTableCollection;

				if (result[0][1].length == 0) {
					var oNumber = $('#Form20181016150505334 #txtNrOrder').val();
					call_GET_ORDER_DETAILS(oNumber);
					return
				}

				var _SAPTable = convertToSAPTable(result, 0);
				var sapReturnTable = _SAPTable;
				var columns = [];
				var columnNames = []

				//alert(JSON.stringify(jsonRecordWithResult.FormID));

				if ($("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").has('tbody')) {
					var arrDataColumn = $("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE'] > thead > tr > th")
					for (i = 0; i < arrDataColumn.length; i++) {
						columnNames.push($(arrDataColumn[i]).html());
						columns.push($(arrDataColumn[i]).attr("imatno"));
					}
				} else {
					$("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").append("<tbody></tbody>");
				}

				//Configure the jqGrid
				var strJqGrid = '<div id="divGrid" class="divGrid" style="width:100% !important; min-width: 100% !important">' +
					'<table id="tableGrid" style="width:100% !important; min-width: 100% !important">' +
					'<tr><td/></tr>' +
					'</table>' +
					'<div id="divPager">' +
					'</div>' +
					'</div>';

				$("#" + jsonRecordWithResult.FormID + " table[itable='tblDataDE']").hide();
				$("#divGrid").remove();
				//ActiveGrid(jsonRecordWithResult.FormID);
				$("#" + jsonRecordWithResult.FormID + " .datacontent").append(strJqGrid);
				// $("#" + jsonRecordWithResult.FormID).append(strJqGrid);

				var arrTableColumnLabel = [];
				var arrTableColumnData = [];

				for (var j = 0; j < columns.length; j++) {

					arrTableColumnLabel.push(columnNames[j]);
					arrTableColumnData.push({
						"name": columns[j],
						"align": "center",
						"index": columns[j],
						"width": "400px",
						"searchoptions": {
							"sopt": ['cn', 'nc', 'bw', 'bn', 'ew', 'en']
						}
					});
				}

				//Check for the Date column
				for (var i = 0; i < sapReturnTable.length; i++) {
					tempArr = {};
					for (key in sapReturnTable[i]) {
						var value = sapReturnTable[i][key];
						if (value) {
							if (CheckingDate(value.toString())) {
								CommonScripts.GetDateInDeviceFormat(new Date(value), 0, sapReturnTable[i], key);
							}
						}
					}
				}
				if (jsonRecordWithResult.ResultObject.IsAttachment == 0) {
					var jsonJQGridValues = {
						ColumnLabel: arrTableColumnLabel,
						ColumnData: arrTableColumnData,
					}

					setTimeout(function () {
						CommonScripts.ShowLoader("Loading data...");
						CommonScripts.BindJQGrid(sapReturnTable, jsonJQGridValues, false, function () {
							CommonScripts.HideLoader();
							$("#divGrid .ui-btn").addClass("ui-alt-icon");
							if (DeviceType == "Tablet") {
								var setHeight = $(window).height() - 400;
								$("#gview_tableGrid").css("height", setHeight);
								var setTableHeight = setHeight - 80;
								$("#divGrid div[data-role='content']").css("height", setTableHeight);

								if (BLProcessFile.SetHeightProcessFile) {
									BLProcessFile.SetHeightProcessFile();
								}
							}



							cbGridLoadComplete(jsonRecordWithResult);
						}, cbOnSortCol);
					}, 100);

				}


				$('#divDisplaySecurityFormCheck').show();

			}
			// -------------------------- End Grid ------------------------------------------
		}
	} catch (e) {
		alert(JSON.stringify(e));
	}
}

/* Added for call process file _Check_Order by Ali Hassan on 2018-10-17 */
function call_GetWarranty(nEquip) {
	//alert(nEquip);
	try {
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181016100404381";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		var column = ['A'];
		var row = [nEquip];
		var temp = [];
		temp.push(column);
		temp.push(row);

		//alert(JSON.stringify(temp));
		var arrHeader = temp;
		var arrFooter = "";

		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();
			alert(JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {
			CommonScripts.HideLoader();

			//------------------- END Form Field -----------------------------------

			//------------------- Grid ---------------------------------------------
			var result = jsonRecordWithResult.ResultObject.ReturnTableCollection;
			//alert(JSON.stringify(result));
			var tableHeaders = result[0][0];
			var tableDatas = result[0][1];

			var columnsOrdem = [];
			var arrDataColumn = $('#' + jsonRecordWithResult.FormID + ' table[itable="tblDataDE"] thead tr th');

			for (i = 0; i < arrDataColumn.length; i++) {
				columnsOrdem.push(tableHeaders.indexOf($(arrDataColumn[i]).attr("imatno")));
			}

			var tableBody = $('#' + jsonRecordWithResult.FormID + ' table[itable="tblDataDE"] tbody');
			$(tableBody).html("");

			for (let l = 0; l < tableDatas.length; l++) {
				var line = tableDatas[l];
				var tableLines = "<tr>";
				for (let c = 0; c < arrDataColumn.length; c++) {
					var column = line[columnsOrdem[c]];
					tableLines += "<td>" + column + "</td>";
				}
				tableLines += "</tr>";
				$(tableBody).append(tableLines);
			}

			$('#divDisplaySecurityFormCheck').hide();
			$('#divDisplayGet_Warranty').show();
			// -------------------------- End Grid ---------------------------------
		}
	} catch (e) {
		alert(JSON.stringify(e));
	}
}

/* Added for call process file _Check_Order by Ali Hassan on 2018-10-31 */
function call_GetText(nOrdem) {
	//alert(nEquip);
	try {
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181024111116308";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		var column = ['A'];
		var row = [nOrdem];
		var temp = [];
		temp.push(column);
		temp.push(row);


		var arrHeader = temp;
		var arrFooter = "";

		//alert("Header: " + JSON.stringify(arrHeader));
		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();

			alert("Error: " + JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {


			//------------------- END Form Field -----------------------------------

			//------------------- Grid ---------------------------------------------
			var result = jsonRecordWithResult.ResultObject;
			//alert("Success: " + JSON.stringify(result));
			$('[itag="btnExecute_GET_ORDERS_DETAILS"]').attr('message', 'testeasd');
			$('[itag="btnExecute_GET_ORDERS_DETAILS"]').show();





			$('[itag="btnExecute_GET_ORDERS_DETAILS"]').attr('message', '');
			var indexText = [];
			for (let i = 0; i < result.ReturnTableCollection[0][1].length; i++) {
				const element = result.ReturnTableCollection[0][1][i];
				if (element[3] == "0000000000") {
					var textmessage = "";
					for (let i = element[9] - 1; i < element[10] - 1; i++) {
						const lineMessage = result.ReturnTableCollection[1][1][i];
						textmessage += lineMessage[1] + "<br/>"
					}


					if (element[2] == "" && element[1] == "" && element[0] != "") {
						$('[itag="btnExecute_GET_ORDERS_DETAILS"]').attr('message', textmessage);
					} else if (element[1] != "" && element[0] != "") {
						//debugger;
						var tableTemp = $('#divGET_ORDERS_DETAILS #tableGrid tr');
						tableTemp.each(function () {
							const columns = $(this).find('td');

							if (columns[0].innerText.trim() == element[1] && columns[1].innerText.trim() == element[2]) {
								//debugger;
								var colImg = $(this).find('td').get(7);
								$(colImg).append("<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAE+ElEQVR42q1Wa1CUVRh+zrdXdhEQViBtNTEcCZDFRDPNG+I9UWt0wqkhL2VokkpiQyqKlxSaGvOCGYiUlxlHS8fJaUZl8sKUoyiy7MAyEKINXpdiuOwuu/v2fqsWMq3DZOeb5/txvvc8z3mf95x3V6D7Q8+Yy5jKiGEEMtoZVsYZxneMxq6LRDfJF6hU6s1Jk6eETp02neJN8SIkJJgcDoeoqbHi7OnTdPjQAYfNZvuSY9cz7N0VUDD2xsbFv5u9cQsGx0RDrVJRc0uLaG2zk0qlFMFBAVBIErXy3OZNOfi2eP+vvGYa40F3BHaNHD1u8da8L9ArpCcsNfU4UVqJ63fdcJIS8LjQV9eBSSYjxgw3oYdeh+KiAmSvW3uJ146VM3mawIwXIiJ/yC/Yj/BQgzh57jKOVbkxfcxQmhIXJgz+amqxu0RJ1QMcOltO/T31Im32WI4NoU3r1wrO5DPm+MSXgDxfuTFvR9TkiYl0vswiCislvJ00GHqtivir/JA3jt9ul4cOnq8VxuZrSJ87gXQapZgw9jU71yTCl8CoiMhB577aUyh7jhVHzRgQGw8/Ldui4CVSp2UkKxC75cEvV6uRNtCO0cPjUVyQj907d2T6Elg3/Y23sj9avgIVtQ2UWekv/IP00OnV0GqVXFxJ8HiYgVsW8BA6PKK52YHY+5doxaxRovFmHd5JmfuTL4ED76WvTpk5MxknK27RrqZQAa0K0HAGKomglIRSIZGSjZKYW2KL4HQLsrvQ/04FrRn3ojAE6pA4esRvvgS+T8tYkzwxaQKOW+9jn6MP4MfkskVqPrlKifcuHtnjAe+ez4vLi8jbFnyaEAZjuAHjRw2740tgX8qCpakzkpNx5V4b5TqeF9CpHopoFAQVF0Li8srlZu/hYJ/4RKGtAy/fukbL4sKFXqPAm69PqvYlsHLEuMm5ixYv4aJKWPwgBM5g7gyyiDcLyTvvzcDplgUgk6PFiXn1F5AU1Q+3G2qxeuWyY74EooINYZWZG/JERL8+tOdGszjTNxphwVrOgo+phjNQcJE9nEEHk7e7qOkPhzBYLViu/pP4UorDRXtw6uTx+U+7aKeTUxYmjk9MorDQEJFl4243JBYRgdonBTiDplYnlZvrxKIGM4xB/qQkl0h/P/VuR4fT5z34mPFh1OAhxjmpaRTgrxPhYQYUtbrRGBdLA/oYRADXwu7yiHpbC9pLL9PspjsiUKmE3k9LO/NyREX51YXMUfBvAtv6RkRmLFqyHEPiYhEQEIAfS0qh02oR3isYDo8bdTo/NGk1ULfb8dw9G3qq1WhpbeMYDY4Uf43S8yVFzDP/cUvoQj4wIyNrA0YmmIQ/N6+Si5do26Zs8ZJpGGLih0KlVHovmMQdlIdgQKNWU9O9RnH0QCHV19Xky9kz3F0FtvLOV2Vk5eDVBBNxZxRl5mr8fKGU8nPX3eTvVi584sAYE3ob+wm9vgd53C5hu38b1eZyqqupquKY1YwTnXcsOtvyiNzbdq8w+dXrFhz8Zjt+v1G7imPyGIPwsNdHM4Lw5C/aRbkzdfVbFshiW3L+scUPZWYrlV23CCYnJpeJV+E/Dlmg4fPdxcYxI4f9bUtZhYUO7t0umDz3WcgfCxz9YGn6LLlzXjFbO9sik2c+C/ljAfnfwak581Jf6T0gWhzZn//MtnQVwCORQkYCQz5mm/8Pcnn8BdofAzKB5Z7nAAAAAElFTkSuQmCC' />");
								$(this).find('td img').attr('message', textmessage);
								$(this).find('td img').click(function () {
									CommonScripts.ShowLoader("Loading...");

									$('#lblGetText').html(
										$(this).attr('message')
									);

									$('#divGET_ORDERS_DETAILS').hide();
									$('#divDisplayGetText').show();

									CommonScripts.HideLoader();
									e.preventDefault();
								});
							}
						});

						console.log(JSON.stringify(tableTemp));
					}
				}
			}
			CommonScripts.HideLoader();
		}
	} catch (e) {
		alert(JSON.stringify(e));
	}
}

function call_Nota(NumeroNota){
	try {
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181026182217193";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		var column = ['A'];
		var row = [NumeroNota];
		var temp = [];
		temp.push(column);
		temp.push(row);


		var arrHeader = temp;
		var arrFooter = "";

		//alert("Header: " + JSON.stringify(arrHeader));
		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();

			alert("Error: " + JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {


			//------------------- Grid ---------------------------------------------
			var result = jsonRecordWithResult.ResultObject;

			$("#divDisplayNotifDetail #txtNota")
			.val(result.SapReturnTable[0].C);
			$(
				"#divDisplayNotifDetail #txtTextoBreveNota"
			).val(result.SapReturnTable[0].D);
			$(
				"#divDisplayNotifDetail #txtLocInst"
			).val(result.SapReturnTable[0].G);
			$(
				"#divDisplayNotifDetail #txtLocInstDesc"
			).val(result.SapReturnTable[0].H);
			$(
				"#divDisplayNotifDetail #txtEquip"
			).val(result.SapReturnTable[0].I);
			$(
				"#divDisplayNotifDetail #txtEquipDesc"
			).val(result.SapReturnTable[0].J);
			$(
				"#divDisplayNotifDetail #txtInicioAvariaData"
			).val(result.SapReturnTable[0].L);
			$(
				"#divDisplayNotifDetail #txtInicioAvariaHora"
			).val(result.SapReturnTable[0].M);
			$(
				"#divDisplayNotifDetail #txtFimAvariaData"
			).val(result.SapReturnTable[0].N);
			$(
				"#divDisplayNotifDetail #txtFimAvariaHora"
			).val(result.SapReturnTable[0].O);
			$(
				'#divDisplayNotifDetail #cbxParada'
			).attr('checked', result.SapReturnTable[
					0].K == "X" ? true :
				false)
			$(
				"#divDisplayNotifDetail #TxtDuracao"
			).val(result.SapReturnTable[0].P);
			$(
				"#divDisplayNotifDetail #TxtDuracaoUnidadeTempo"
			).val(result.SapReturnTable[0].Q);
			$('#accordionNotifDetail').show();
			
			$('#divDisplayNotifCausas').hide();
			$('#divDisplayNotifAtividade').hide();
			$('#divDisplayNotifAnexo').hide();
			$('#divDisplayNotifItens').hide();


			DataBinding($(
				'#divDisplayNotifItens #tbTeste'
			), result.ReturnTableCollection[
				2]);

			DataBinding($(
				'#divDisplayNotifCausas #tbTeste'
			), result.ReturnTableCollection[
				1]);

			DataBinding($(
				'#divDisplayNotifAtividade #tbTeste'
			), result.ReturnTableCollection[
				0]);

			

			$('.customButtonRunTime').remove();
			$('#divDisplayNotif #menu').append(
				'<a class="customButtonRunTime button" onclick="\
				$(\'#divDisplayNotif\').hide();\
				$(\'#divMainScreen\').show();\
				$(\'.customButtonRunTime\').remove();">voltar</a>'
			);

			$('#divDisplayNotif #menu').append('<a class="button customButtonRunTime" onclick="\
				call_Nota($(\'#divDisplayNotif #txtNotifNumber\').val())" >Executar</a>');

			$('#divDisplayNotif #menu').append(
				'<a class="customButtonRunTime button" onclick="\
				$(\'#divDisplayNotifDetail\').show();\
				$(\'#divDisplayNotifCausas\').hide();\
				$(\'#divDisplayNotifAtividade\').hide();\
				$(\'#divDisplayNotifAnexo\').hide();\
				$(\'#divDisplayNotifItens\').hide();\" >Dados da Nota</a>'
			);

			$('#divDisplayNotif #menu').append(
				'<a class="customButtonRunTime button" onclick="\
				$(\'#divDisplayNotifDetail\').hide();\
				$(\'#divDisplayNotifCausas\').hide();\
				$(\'#divDisplayNotifAtividade\').hide();\
				$(\'#divDisplayNotifAnexo\').hide();\
				$(\'#divDisplayNotifItens\').show();\" >Itens</a>'
			);

			$('#divDisplayNotif #menu').append(
				'<a class="customButtonRunTime button" onclick="\
				$(\'#divDisplayNotifDetail\').hide();\
				$(\'#divDisplayNotif #divDisplayNotifItens\').hide();\
				$(\'#divDisplayNotif #divDisplayNotifAtividade\').hide();\
				$(\'#divDisplayNotif #divDisplayNotifAnexo\').hide();\
				$(\'#divDisplayNotif #divDisplayNotifCausas\').show();\
				" >Causas</a>'
			);
			$('#divDisplayNotif #menu').append(
				'<a class="customButtonRunTime button" onclick="\
				$(\'#divDisplayNotifDetail\').hide();\
				$(\'#divDisplayNotifItens\').hide();\
				$(\'#divDisplayNotifAtividade\').show();\
				$(\'#divDisplayNotifAnexo\').hide();\
				$(\'#divDisplayNotifCausas\').hide();\
				" >Atividade</a>'
			);
			$('#divDisplayNotif #menu').append(
				'<a class="customButtonRunTime button" onclick="\
				$(\'#divDisplayNotifDetail\').hide();\
				$(\'#divDisplayNotifItens\').hide();\
				$(\'#divDisplayNotifAtividade\').hide();\
				$(\'#divDisplayNotifAnexo\').show();\
				$(\'#divDisplayNotifCausas\').hide();\
				" >Anexo</a>'
			);


			
			 setTimeout(function () {
				call_NotaConverteDuracao($("#divDisplayNotifDetail #TxtDuracao").val());
			 }, 100);

			CommonScripts.HideLoader();
		}
	} catch(e) {
		alert(JSON.stringify(e));
	}
}

function call_NotaConverteDuracao(duracao){
	try {
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181031144153371";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		var column = ['A'];
		var row = [duracao];
		var temp = [];
		temp.push(column);
		temp.push(row);


		var arrHeader = temp;
		var arrFooter = "";

		//alert("Header: " + JSON.stringify(arrHeader));
		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();

			alert("Error: " + JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {
			var result = jsonRecordWithResult.ResultObject;
			$('#divDisplayNotifDetail #TxtDuracao').val(result.SapReturnTable[0].C);
			setTimeout(function () {
				call_NotaNInventario($("#divDisplayNotifDetail #txtEquip").val());
			 }, 100);
		}
	} catch(e) {
		alert(JSON.stringify(e));
	}
}

function call_NotaNInventario(nEquipamento){
	try {
		var IsTestRun = 0,
			IsSave = 0,
			IsDirectPost = 1,
			IsReview = 0,
			IsReset = 0;
		var strAction = "";
		var PostType = "SAP";

		switch (PostType) {
			case "SAP":
				IsDirectPost = 1;
				strAction = $("[itag='btnSendToSAP']").attr("data-mfb-label");
				break;
		}

		var UserNote = "";
		var FileType = "BAPI/RFM";

		if (PostType == "reset") {
			BLProcessFile.ResetForm();
			return;
		}

		var jsonInformation = {};
		jsonInformation.PostType = PostType;
		jsonInformation.ProcessType = FileType;
		jsonInformation.FormID = "Form20181023180707676";
		jsonInformation.Action = strAction;

		jsonInformation.IsTestRun = IsTestRun;
		jsonInformation.IsReviewData = IsReview; //IsReviewData
		jsonInformation.IsSave = IsSave;
		jsonInformation.IsDirectPost = IsDirectPost; //IsDirectPost

		jsonInformation.UserNote = UserNote;

		jsonInformation.UniqueID = CommonScripts.GetUniqueCode();
		jsonInformation.DataID = CommonScripts.GetGUID();

		jsonInformation.AdditionalData = [];
		jsonInformation.AutoShowresult = 0;
		jsonInformation.IsDoNotSaveInSentbox = 0;
		jsonInformation.IsUpdate = 0;
		jsonInformation.DoNotDisableForm = 1;
		//jsonInformation.MYSAPSSO2 = 0;

		var column = ['A'];
		var row = [nEquipamento];
		var temp = [];
		temp.push(column);
		temp.push(row);


		var arrHeader = temp;
		var arrFooter = "";

		//alert("Header: " + JSON.stringify(arrHeader));
		/* Generate the object to be save or to send to IWMS  */
		jsonInformation.HeaderData = JSON.stringify(arrHeader);
		jsonInformation.LoopData = JSON.stringify(arrFooter);

		BLProcessFile.ProcessOperation(jsonInformation, ProcessOperationError, ProcessOperationSuccess);

		function ProcessOperationError(jsonError) {
			CommonScripts.HideLoader();

			alert("Error: " + JSON.stringify(jsonError));
		}


		function ProcessOperationSuccess(jsonRecordWithResult) {
			var result = jsonRecordWithResult.ResultObject;
			$('#divDisplayNotifDetail #txtNInventario').val(result.SapReturnTable[0].C);
		}
	} catch(e) {
		alert(JSON.stringify(e));
	}
}
















/* Added for call process file _Check_Order by Ali Hassan on 2018-11-01 */
/* Function to Binding DataTable */
function DataBinding(jqueryTableElement, data) {
	if ($(jqueryTableElement).parent().find("#887999283-pagination").length > 0)
		$(jqueryTableElement).parent().find("#887999283-pagination").remove();

	var totalPage = Math.trunc(data[1].length / 10);
	if (data[1].length / 10 - Math.trunc(data[1].length / 10) > 0)
		totalPage++;

	if ($(jqueryTableElement).attr("DataFont") != "filtered")
		localStorage.setItem($(jqueryTableElement).selector, JSON.stringify(data))


	$(jqueryTableElement).attr("pageIndex", 0);
	$(jqueryTableElement).attr("totalPage", totalPage);

	if ($(jqueryTableElement).parent().find("#887999283-searche").length == 0) {
		$(
			'<div id="887999283-searche">Localizar: <input type="text" id="txtSearche" style="margin:20px 0px 20px 0px;" uuid="' +
			$(jqueryTableElement).selector + '"></div>').insertBefore($(
			jqueryTableElement));
		$(jqueryTableElement).parent().find('#txtSearche').on("change paste keyup",
			function () {
				filter(this);
			});
	}

	var paginationVar =
		'<div id="887999283-pagination" class="row"><div class="col-sm-4" style="height: 70px;line-height: 70px;">Exibindo <span id="lblBeginIndex"></span> até <span id="lblEndIndex"></span> de ' +
		data[1].length +
		' registros</div> <div class="col-sm-8" style="text-align: right"><ul class="pagination"><li class="fg-button ui-button ui-state-default first " id="btnFirst" uuid="' +
		$(jqueryTableElement).selector +
		'"><a href="#">Primeiro</a></li><li class="fg-button ui-button ui-state-default previous " id="BtnPrevious" uuid="' +
		$(jqueryTableElement).selector + '"><a href="#">Anterior</a></li>';
	for (let ipage = 0; ipage < totalPage; ipage++) {
		var activeVar = ipage == 0 ? 'active' : '';
		var pageHidden = ipage > 4 ? 'hidden' : '';
		paginationVar += '<li class="fg-button ui-button ui-state-default ' + activeVar +
			' ' + pageHidden + '" id="liPage' + ipage +
			'"><a href="#" aria-controls="btnPage" id="btnPage' + ipage + '" iPage="' +
			ipage + '" uuid="' + $(jqueryTableElement).selector + '">' + (ipage + 1) +
			'</a></li>';
	}
	paginationVar +=
		'<li class="fg-button ui-button ui-state-default next" id="BtnNext" uuid="' + $(
			jqueryTableElement).selector +
		'" ><a href="#">Proximo</a></li><li class="fg-button ui-button ui-state-default last " id="BtnLast" uuid="' +
		$(jqueryTableElement).selector + '"><a href="#">Ultimo</a></li></ul></div></div>'
	$(paginationVar).insertAfter($(jqueryTableElement));

	var table = $(jqueryTableElement);

	$(jqueryTableElement).parent().find('[aria-controls="btnPage"]').on("click touchend", function () {
		switchPage(this);
	});

	$(jqueryTableElement).parent().find('#btnFirst').on("click touchend",function () {

		var pageCurrentIndex = $(jqueryTableElement).attr("pageIndex") * 1;
		var elementAux = $(jqueryTableElement).parent().find('#btnPage0');
		switchPage(elementAux);
	});
	$(jqueryTableElement).parent().find('#BtnPrevious').on("click touchend",function () {

		var pageCurrentIndex = $(jqueryTableElement).attr("pageIndex") * 1 - 1;
		var elementAux = $(jqueryTableElement).parent().find('#btnPage' +
			pageCurrentIndex);
		switchPage(elementAux);
	});
	$(jqueryTableElement).parent().find('#BtnNext').on("click touchend",function () {

		var pageCurrentIndex = $(jqueryTableElement).attr("pageIndex") * 1 + 1;
		var elementAux = $(jqueryTableElement).parent().find('#btnPage' +
			pageCurrentIndex);
		switchPage(elementAux);
	});
	$(jqueryTableElement).parent().find('#BtnLast').on("click touchend",function () {

		var pageCurrentIndex = $(jqueryTableElement).attr("totalpage") * 1 - 1;
		var elementAux = $(jqueryTableElement).parent().find('#btnPage' +
			pageCurrentIndex);
		switchPage(elementAux);
	});



	createRows(jqueryTableElement, 0);

}

var filterValueBefore = "";

function filter(elementInput) {

	if (filterValueBefore != $(elementInput).val()) {
		var tableName = $(elementInput).attr("uuid");
		var filterValueAfter = $(elementInput).val();


		if ($(elementInput).val().length > 0) {
			var DataBefore = JSON.parse(localStorage.getItem($(tableName).selector));
			var DataAfter = [DataBefore[0],
				[]
			];
			$($(tableName).selector).attr("DataFont", "filtered");



			for (let iLine = 0; iLine < DataBefore[1].length; iLine++) {
				const item = DataBefore[1][iLine];

				if (item.toString().indexOf(filterValueAfter) > 0)
					DataAfter[1].push(item);
			}


			localStorage.setItem($(tableName).selector + "_Filtered", JSON.stringify(
				DataAfter))
			DataBinding($(tableName), DataAfter);
		} else {
			$($(tableName).selector).attr("DataFont", "original");
			localStorage.removeItem($(tableName).selector + "_Filtered");
			DataBinding($(tableName), JSON.parse(localStorage.getItem($(tableName).selector)));
		}
		filterValueBefore = $(elementInput).val();
	}

}

function createRows(jqueryTableElement, iPage) {



	var data = null;
	if ($(jqueryTableElement).attr("DataFont") == "filtered")
		data = JSON.parse(localStorage.getItem($(jqueryTableElement).selector +
			"_Filtered"));
	else
		data = JSON.parse(localStorage.getItem($(jqueryTableElement).selector));

	var imatnoIndex = returnImatno(jqueryTableElement, data);



	var strLine = "";
	var lastIndex = 0;
	for (let iLine = iPage * 10; iLine < iPage * 10 + 10 && iLine < data[1].length; iLine++) {

		strLine += "<tr>";
		for (let iColumn = 0; iColumn < imatnoIndex.length; iColumn++) {
			const columnIndex = imatnoIndex[iColumn];
			if (columnIndex >= 0)
				strLine += "<td>" + data[1][iLine][columnIndex] + "</td>";
			else
				strLine += "<td></td>";
		}
		strLine += "</tr>";
		lastIndex = iLine;
	}
	$(jqueryTableElement).parent().find("#lblBeginIndex").text(iPage * 10 + 1);
	$(jqueryTableElement).parent().find("#lblEndIndex").text(lastIndex + 1);

	$(jqueryTableElement).find(' tbody').html(strLine);
}

function switchPage(jqueryElement) {
	var jqueryTableElement = $($(jqueryElement).attr("uuid"));


	var iPage = $(jqueryElement).attr("iPage") * 1;
	$(jqueryTableElement).attr("pageIndex", iPage);
	var totalPage = $(jqueryTableElement).attr("totalpage");

	$(jqueryTableElement).parent().find('[aria-controls="btnPage"]').parent('li').addClass(
		"hidden");
	$(jqueryTableElement).parent().find('li').removeClass("active");
	$(jqueryElement).parent('li').addClass("active");

	for (let iLi = iPage - 2; iLi < totalPage && iLi <= iPage + 2; iLi++) {
		$(jqueryTableElement).parent().find('#liPage' + iLi).removeClass("hidden");
	}

	if (iPage <= 2) {
		$(jqueryTableElement).parent().find('#liPage3').removeClass("hidden");
		$(jqueryTableElement).parent().find('#liPage4').removeClass("hidden");
	}

	createRows(jqueryTableElement, iPage);
}

function returnImatno(jqueryTableElement, data) {
	var imatnoIndex = [];


	$(jqueryTableElement).find(' thead tr th').each(function () {

		var finded = false;

		var columnName = $(this).attr('imatno');
		for (let iColumn = 0; iColumn < data[0].length; iColumn++) {
			const element = data[0][iColumn];
			if (element == columnName) {
				imatnoIndex.push(iColumn);
				finded = true;
				continue;
			}
		}

		if (!finded)
			imatnoIndex.push(-1);
	});
	return imatnoIndex;
}

function guid() {
	function s4() {
		return Math.floor((1 + Math.random()) * 0x10000)
			.toString(16)
			.substring(1);
	}
	return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
}